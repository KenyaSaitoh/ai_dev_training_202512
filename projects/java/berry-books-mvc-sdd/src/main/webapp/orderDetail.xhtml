<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core">
<h:head>
    <title>OrderDetailPage</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <h:outputStylesheet library="css" name="style.css"/>
    <f:metadata>
        <f:viewParam name="tranId" value="#{orderHistoryBean.orderTranId}" />
        <f:viewParam name="detailId" value="#{orderHistoryBean.selectedDetailId}" />
        <f:viewAction action="#{orderHistoryBean.loadOrderDetail}" />
    </f:metadata>
</h:head>
<h:body>
    <h2>注文した書籍の詳細情報</h2>
    <hr />
    <table class="order-detail-table">
        <tr>
            <td>注文日</td>
            <td>#{orderHistoryBean.orderSummary.orderTran.orderDate}</td>
            <td rowspan="5" class="book-image-cell">
                <h:graphicImage library="images" 
                              name="covers/#{orderHistoryBean.orderSummary.orderDetails[0].book.bookName.replace(' ', '_')}.jpg"
                              alt="#{orderHistoryBean.orderSummary.orderDetails[0].book.bookName}"
                              styleClass="book-thumbnail"
                              onError="this.onerror=null; this.src='#{request.contextPath}/jakarta.faces.resource/no-image.jpg?ln=images/covers'" />
            </td>
        </tr>
        <tr>
            <td>書籍名</td>
            <td>#{orderHistoryBean.orderSummary.orderDetails[0].book.bookName}</td>
        </tr>
        <tr>
            <td>出版社</td>
            <td>#{orderHistoryBean.orderSummary.orderDetails[0].book.publisher.publisherName}</td>
        </tr>
        <tr>
            <td>カテゴリ</td>
            <td>#{orderHistoryBean.orderSummary.orderDetails[0].book.category.categoryName}</td>
        </tr>
        <tr>
            <td>価格</td>
            <td>
                <h:outputText value="#{orderHistoryBean.orderSummary.orderDetails[0].price}">
                    <f:convertNumber pattern="#,###" />
                </h:outputText>
            </td>
        </tr>
    </table>
    <hr />
    <h:link id="toSelectLink" value="書籍の選択ページへ" outcome="bookSelect" />
    <br />
    <h:link id="toSearchLink" value="書籍の検索ページへ" outcome="bookSearch" />
</h:body>
</html>



